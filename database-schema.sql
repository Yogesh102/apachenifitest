CREATE TABLE documents (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    folder_path VARCHAR2(255),
    file_name VARCHAR2(255),
    version NUMBER,
    download_status VARCHAR2(50),
    error_message CLOB,
    timestamp TIMESTAMP
);

CREATE TABLE reconciliation_reports (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    total_files NUMBER,
    downloaded_files NUMBER,
    failed_files NUMBER,
    timestamp TIMESTAMP
);

ALTER TABLE documents ADD migration_tracker_id NUMBER;

ALTER TABLE documents ADD CONSTRAINT fk_migration_tracker
FOREIGN KEY (migration_tracker_id)
REFERENCES migration_tracker(id);

CREATE TABLE migration_tracker (
    id SERIAL PRIMARY KEY,
    csv_file_name VARCHAR(255),
    from_date TIMESTAMP,
    to_date TIMESTAMP,
    start_time TIMESTAMP,
    end_time TIMESTAMP,
    status VARCHAR(50)
);

SELECT COUNT(*) AS total_files, SUM(CASE WHEN download_status = 'success' THEN 1 ELSE 0 END) AS downloaded_files,SUM(CASE WHEN download_status = 'failure' THEN 1 ELSE 0 END) AS failed_files FROM documents
